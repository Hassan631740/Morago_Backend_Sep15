spring.application.name=morago-backend
spring.thymeleaf.cache=false
spring.profiles.active=${SPRING_PROFILES_ACTIVE:local}

## Database Configuration - Default values (overridden by profile-specific files)
# MySQL Configuration (commented out - use profile-specific files)
#spring.datasource.url=${DB_URL}
#spring.datasource.username=${DB_USERNAME}
#spring.datasource.password=${DB_PASSWORD}
#spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# Connection pool settings
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000

# JPA/Hibernate Configuration
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.hbm2ddl.auto=update
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
spring.flyway.baseline-on-migrate=false

# Server Configuration
server.address=0.0.0.0
server.port=${PORT:8080}
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html

# Session Management Configuration
server.servlet.session.timeout=30m
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.secure=false
server.servlet.session.cookie.same-site=strict
server.servlet.session.tracking-modes=cookie

# Logging
logging.level.org.springframework.security=DEBUG
logging.level.com.zaxxer.hikari=INFO
logging.level.org.springframework.jdbc=DEBUG
logging.level.com.example.Student.Information.System=DEBUG
logging.level.org.springframework.security.authentication=TRACE

# JWT - Default values (overridden by profile-specific files)
jwt.expiration=${JWT_EXPIRATION}
security.jwt.secret=${SECURITY_JWT_SECRET}
security.jwt.expiration-ms=${JWT_EXPIRATION_MS}
security.jwt.refresh-expiration-ms=${JWT_REFRESH_EXPIRATION_MS}

# Socket.IO server - Default values (overridden by profile-specific files)
socketio.host=${SOCKETIO_HOST}
socketio.port=${SOCKETIO_PORT}
socketio.allowed-origins=${SOCKETIO_ALLOWED_ORIGINS}

# AWS S3 Storage Configuration
storage.s3.bucket=${AWS_S3_BUCKET}
storage.s3.region=${AWS_S3_REGION}
storage.s3.access-key=${AWS_S3_ACCESS_KEY}
storage.s3.secret-key=${AWS_S3_SECRET_KEY}
storage.s3.endpoint=${AWS_S3_ENDPOINT}
storage.s3.base-url=${AWS_S3_BASE_URL:https://morago-backend-files.s3.ap-northeast-2.amazonaws.com}

# File Upload Configuration
spring.servlet.multipart.max-file-size=${MAX_FILE_SIZE:10MB}
spring.servlet.multipart.max-request-size=${MAX_REQUEST_SIZE:10MB}
spring.servlet.multipart.enabled=true

# Actuator configuration
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=always
management.endpoint.health.probes.enabled=true
management.health.livenessState.enabled=true
management.health.readinessState.enabled=true
management.endpoints.web.base-path=/actuator

# Default datasource is empty; use profile-specific files (e.g., prod on Railway)
# MySQL default hints (safe fallbacks for local dev if envs provided)
spring.datasource.url=${DATABASE_URL:}
spring.datasource.username=${DB_USERNAME:}
spring.datasource.password=${DB_PASSWORD:}
spring.datasource.driver-class-name=${DB_DRIVER:com.mysql.cj.jdbc.Driver}

spring.jpa.database-platform=${DB_DIALECT:org.hibernate.dialect.MySQLDialect}
spring.h2.console.enabled=false